<mujoco model="fr3">
  <compiler angle="radian" meshdir="/home/zhoudaoyuan/fr3_ws/src/franka_description/meshes/"/>

  <option timestep="0.002" gravity="0 0 -9.81" iterations="100" tolerance="1e-8" solver="Newton"/>

  <visual>
      <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
      <rgba haze="0.15 0.25 0.35 1"/>
      <global azimuth="120" elevation="-20"/>
  </visual>
    <default>
        <joint armature="0.1" damping="1.0" frictionloss="0.1"/>
    </default>
  <asset>
    <mesh name="link0" file="robot_arms/fr3/collision/link0.stl"/>
    <mesh name="link1" file="robot_arms/fr3/collision/link1.stl"/>
    <mesh name="link2" file="robot_arms/fr3/collision/link2.stl"/>
    <mesh name="link3" file="robot_arms/fr3/collision/link3.stl"/>
    <mesh name="link4" file="robot_arms/fr3/collision/link4.stl"/>
    <mesh name="link5" file="robot_arms/fr3/collision/link5.stl"/>
    <mesh name="link6" file="robot_arms/fr3/collision/link6.stl"/>
    <mesh name="link7" file="robot_arms/fr3/collision/link7.stl"/>
    <mesh name="hand" file="robot_ee/franka_hand_black/collision/hand.stl"/>
    
    <mesh name="finger" file="robot_ee/franka_hand_black/collision/finger.stl"/>
    <mesh name="finger_visual" file="robot_ee/franka_hand_black/visual/finger.stl"/>

    <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512" height="3072"/>
    <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3" markrgb="0.8 0.8 0.8" width="300" height="300"/>
    <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5" reflectance="0.2"/>
  </asset>

  <worldbody>
    <light pos="0 0 3" dir="0 0 -1" directional="true"/>
    <geom name="floor" type="plane" size="0 0 0.05" material="groundplane" contype="1" conaffinity="1" group="0"/>


<camera name="camera1" 
        resolution="640 480"
        mode="fixed" 
        pos="-2.8 -2.8 2.1" 
        xyaxes="0.707 -0.707 0 0.408 0.408 0.816" 
        fovy="45"/>

    <geom name="fr3_link0_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link0"/>
    <geom name="fr3_link0_collision" type="mesh" mesh="link0"/>
    
    <body name="fr3_link1" pos="0 0 0.333">
      <inertial pos="4.128e-07 -0.0181251 -0.0386036" quat="0.998098 -0.0605364 0.00380499 0.0110109" mass="2.92747" diaginertia="0.0239286 0.0227246 0.00610634"/>
      <joint name="fr3_joint1" pos="0 0 0" axis="0 0 1" range="-2.9007 2.9007" actuatorfrcrange="-87 87" damping="0.003" frictionloss="0.2"/>
      <geom name="fr3_link1_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link1"/>
      <geom name="fr3_link1_collision" type="mesh" mesh="link1" 
      contype="1" conaffinity="1" />
      
      <body name="fr3_link2" quat="0.707107 -0.707107 0 0">
        <inertial pos="0.00318289 -0.0743222 0.00881461" quat="0.502599 0.584437 -0.465998 0.434366" mass="2.93554" diaginertia="0.0629567 0.0411924 0.0246371"/>
        <joint name="fr3_joint2" pos="0 0 0" axis="0 0 1" range="-1.8361 1.8361" actuatorfrcrange="-87 87" damping="0.003" frictionloss="0.2"/>
        <geom name="fr3_link2_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link2"/>
        <geom name="fr3_link2_collision" type="mesh" mesh="link2" contype="1" conaffinity="1" group="0"/>
        
        <body name="fr3_link3" pos="0 -0.316 0" quat="0.707107 0.707107 0 0">
          <inertial pos="0.0407016 -0.00482006 -0.0289731" quat="0.921025 -0.244161 0.155272 0.260745" mass="2.2449" diaginertia="0.0267409 0.0189869 0.0171587"/>
          <joint name="fr3_joint3" pos="0 0 0" axis="0 0 1" range="-2.9007 2.9007" actuatorfrcrange="-87 87" damping="0.003" frictionloss="0.2"/>
          <geom name="fr3_link3_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link3"/>
          <geom name="fr3_link3_collision" type="mesh" mesh="link3" contype="1" conaffinity="1" group="0"/>
          
          <body name="fr3_link4" pos="0.0825 0 0" quat="0.707107 0.707107 0 0">
            <inertial pos="-0.0459101 0.0630493 -0.00851879" quat="0.438018 0.803311 0.00937812 0.403414" mass="2.6156" diaginertia="0.05139 0.0372717 0.0160047"/>
            <joint name="fr3_joint4" pos="0 0 0" axis="0 0 1" range="-3.077 -0.1169" actuatorfrcrange="-87 87" damping="0.003" frictionloss="0.2"/>
            <geom name="fr3_link4_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link4"/>
            <geom name="fr3_link4_collision" type="mesh" mesh="link4" contype="1" conaffinity="1" group="0"/>
            
            <body name="fr3_link5" pos="-0.0825 0.384 0" quat="0.707107 -0.707107 0 0">
              <inertial pos="-0.00160396 0.0292536 -0.0972966" quat="0.919031 0.125604 0.0751531 -0.366003" mass="2.32712" diaginertia="0.0579335 0.0449144 0.0130634"/>
              <joint name="fr3_joint5" pos="0 0 0" axis="0 0 1" range="-2.8763 2.8763" actuatorfrcrange="-12 12" damping="0.003" frictionloss="0.2"/>
              <geom name="fr3_link5_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link5"/>
              <geom name="fr3_link5_collision" type="mesh" mesh="link5" contype="1" conaffinity="1" group="0"/>
              
              <body name="fr3_link6" quat="0.707107 0.707107 0 0">
                <inertial pos="0.0597131 -0.0410295 -0.0101693" quat="0.621301 0.552665 0.510011 0.220081" mass="1.81704" diaginertia="0.0175039 0.0161123 0.00193529"/>
                <joint name="fr3_joint6" pos="0 0 0" axis="0 0 1" range="0.4398 4.6216" actuatorfrcrange="-12 12" damping="0.003" frictionloss="0.2"/>
                <geom name="fr3_link6_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link6"/>
                <geom name="fr3_link6_collision" type="mesh" mesh="link6" 
      contype="1" conaffinity="1" group="0"/>
                
                <body name="fr3_link7" pos="0.088 0 0" quat="0.707107 0.707107 0 0">
                  <inertial pos="0.002194 -0.0443282 0.00191499" quat="0.791293 0.607207 -0.0567169 0.044037" mass="1.28154" diaginertia="0.00593024 0.00557291 0.000548948"/>
                  <joint name="fr3_joint7" pos="0 0 0" axis="0 0 1" range="-3.0508 3.0508" actuatorfrcrange="-12 12" damping="0.003" frictionloss="0.2"/>
                  <geom name="fr3_link7_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link7"/>
                  <geom name="fr3_link7_collision" type="mesh" mesh="link7" contype="1" conaffinity="1" group="0"/>
                  <geom name="fr3_hand_visual" pos="0 0 0.107" quat="1 0 0 0" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="hand"/>
                  <geom name="fr3_hand_collision" pos="0 0 0.107" quat="1 0 0 0" type="mesh" mesh="hand" contype="1" conaffinity="1" group="0"/>
                  
                  <body name="fr3_leftfinger" pos="0 0 0.1654">
                    <inertial pos="0 0.015285 0.0219675" quat="0.705067 -0.0536699 0.0536699 0.705067" mass="0.0291" diaginertia="8.69232e-06 8.49e-06 1.60768e-06"/>
                    <joint name="fr3_finger_joint1" pos="0 0 0" axis="0 1 0" type="slide" range="0 0.04" actuatorfrcrange="-100 100" damping="0.3"/>
                    <geom name="fr3_leftfinger_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="finger_visual"/>
                                        <!-- 碰撞体：screw mount -->
                    <geom name="left_screw_mount" type="box" size="0.011 0.0075 0.01"
                          pos="0 0.0185 0.011" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：cartridge sledge -->
                    <geom name="left_cartridge" type="box" size="0.011 0.0044 0.0019"
                          pos="0 0.0068 0.0022" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：diagonal finger -->
                    <geom name="left_diagonal" type="box" size="0.00875 0.0035 0.01175"
                          pos="0 0.0159 0.02835" quat="0 0 0 0.9659" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：rubber tip -->
                    <geom name="left_tip" type="box" size="0.00875 0.0076 0.00925"
                          pos="0 0.00758 0.04525" contype="1" conaffinity="1"/>
                  </body>
                  
                  <body name="fr3_rightfinger" pos="0 0 0.1654" quat="0 0 0 1">
                    <inertial pos="0 0.015285 0.0219675" quat="0.705067 -0.0536699 0.0536699 0.705067" mass="0.0291" diaginertia="8.69232e-06 8.49e-06 1.60768e-06"/>
                    <joint name="fr3_finger_joint2" pos="0 0 0" axis="0 1 0" type="slide" range="0 0.04" actuatorfrcrange="-100 100" damping="0.3"/>
                    <geom name="fr3_rightfinger_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="finger_visual"/>
                    <!-- 碰撞体：screw mount -->
                    <geom name="right_screw_mount" type="box" size="0.011 0.0075 0.01"
                          pos="0 0.0185 0.011" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：cartridge sledge -->
                    <geom name="right_cartridge" type="box" size="0.011 0.0044 0.0019"
                          pos="0 0.0068 0.0022" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：diagonal finger -->
                    <geom name="right_diagonal" type="box" size="0.00875 0.0035 0.01175"
                          pos="0 0.0159 0.02835" quat="0 0 0 0.9659" contype="1" conaffinity="1"/>

                    <!-- 碰撞体：rubber tip -->
                    <geom name="right_tip" type="box" size="0.00875 0.0076 0.00925"
                          pos="0 0.00758 0.04525" contype="1" conaffinity="1"/>
                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
    <!-- 障碍物 -->
  <!-- <body name="obstacle" pos="0.375 -0.25 0.5">
    <geom
      name="obstacle_geom"
      type="box"
      size="0.05 0.05 0.5"
      rgba="1 0 0 1"
      contype="1" 
      conaffinity="1"
      group="0"/>
  </body> -->

  <body name="table1" pos="0.4 -0.25 0.1">
    <geom
      name="table1_geom"
      type="box"
      size="0.1 0.1 0.1"
      rgba="0 1 0 1"
      contype="1" 
      conaffinity="1"
       group="0" />
      </body> 
  <body name="table2" pos="0 -0.5 0.1">
    <geom
      name="table2_geom"
      type="box"
      size="0.1 0.1 0.1"
      rgba="0 1 0 1"
      contype="1" 
      conaffinity="1"
       group="0" />
      </body> 
<body name="target1" pos="0 -0.5 0.25">
    <joint name="target_joint" type="free" damping="0.001"/>
    <geom
      name="target_geom"
      type="box"
      size="0.025 0.025 0.05"
      rgba="0 0 1 1"
      contype="1"
      conaffinity="1"
      group="0"
      mass="0.1"
      friction="1 0.01 0.001"
      solimp="0.9 0.95 0.001" 
      solref="0.02 1"/>
  </body>

  <!-- <body name="hoop_object" pos="0.0 -0.25 0.21">
    <joint type="free" damping="0.1" armature="0.001"/>
    
    <geom name="hoop_bottom" type="box" size="0.05 0.01 0.01" pos="0 0 0" 
          mass="0.05" friction="2.0 0.5 0.01" solref="0.02 1.5" solimp="0.9 0.95 0.001" contype="1" conaffinity="1" />
    
    <geom name="hoop_left" type="box" size="0.001 0.001 0.05" pos="-0.05 0 0.05" 
          mass="0.02" friction="2.0 0.5 0.01" solref="0.02 1.5" solimp="0.9 0.95 0.001" contype="1" conaffinity="1" />
    
    <geom name="hoop_right" type="box" size="0.001 0.001 0.05" pos="0.05 0 0.05" 
          mass="0.02" friction="2.0 0.5 0.01" solref="0.02 1.5" solimp="0.9 0.95 0.001" contype="1" conaffinity="1" />
    
    <geom name="hoop_top" type="box" size="0.05 0.001 0.001" pos="0 0 0.1" 
          mass="0.03" friction="2.0 0.5 0.01" solref="0.02 1.5" solimp="0.9 0.95 0.001" contype="1" conaffinity="1" />
  </body> -->
  </worldbody>
  <equality>
    <!-- fr3_finger_joint2 = fr3_finger_joint1 -->
    <joint
      joint1="fr3_finger_joint1"
      joint2="fr3_finger_joint2"
      polycoef="0 1 0 0 0"/>
  </equality>

  <actuator>

    <!-- ================== Arm joints ================== -->

    <position
      name="fr3_joint1"
      joint="fr3_joint1"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-200 200"/>

    <position
      name="fr3_joint2"
      joint="fr3_joint2"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-200 200"/>

    <position
      name="fr3_joint3"
      joint="fr3_joint3"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-150 150"/>

    <position
      name="fr3_joint4"
      joint="fr3_joint4"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-120 120"/>

    <position
      name="fr3_joint5"
      joint="fr3_joint5"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-80 80"/>

    <position
      name="fr3_joint6"
      joint="fr3_joint6"
      kp="1500"
      dampratio="2.0"
      ctrlrange="-3.14 3.14"
      forcerange="-60 60"/>

    <position
      name="fr3_joint7"
      joint="fr3_joint7"
      kp="800"
      dampratio="1.0"
      ctrlrange="-3.14 3.14"
      forcerange="-40 40"/>

    <!-- ================== Hand ================== -->

    <!-- 只给一个 actuator，另一个通过 equality 跟随 -->
    <position
      name="fr3_finger_joint1"
      joint="fr3_finger_joint1"
      kp="300"
      dampratio="1.5"
      ctrlrange="0.0 0.04"
      forcerange="-20 20"/>

  </actuator>


</mujoco>